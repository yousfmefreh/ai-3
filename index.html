<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ â€” ForensicAI</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Kufi+Arabic:wght@300;400;500;600;700;900&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --navy:     #0b1628;
  --navy2:    #0f1e36;
  --navy3:    #152542;
  --gold:     #c9a84c;
  --gold2:    #e8c97a;
  --gold-dim: rgba(201,168,76,0.12);
  --white:    #f0f4fa;
  --white2:   #c8d4e8;
  --white3:   #7a8fa8;
  --red:      #e05252;
  --green:    #3dbf8a;
  --border:   rgba(201,168,76,0.15);
  --border2:  rgba(240,244,250,0.06);
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
  font-family:'Noto Kufi Arabic',sans-serif;
  background:var(--navy); color:var(--white);
  min-height:100vh; overflow-x:hidden;
}
body::before {
  content:''; position:fixed; inset:0;
  background:radial-gradient(ellipse 80% 50% at 50% -20%, rgba(201,168,76,0.05) 0%, transparent 60%);
  pointer-events:none; z-index:0;
}

/* HEADER */
header {
  position:relative; z-index:20;
  background:rgba(11,22,40,0.98);
  border-bottom:1px solid var(--border);
  height:62px; display:flex; align-items:center;
  justify-content:space-between; padding:0 28px;
}
.logo { display:flex; align-items:center; gap:14px; }
.logo-icon {
  width:36px; height:36px; border:1.5px solid var(--gold);
  border-radius:8px; display:flex; align-items:center;
  justify-content:center; font-size:17px; background:var(--gold-dim);
}
.logo-title { font-size:14px; font-weight:700; }
.logo-sub { font-size:10px; color:var(--gold); font-family:'DM Mono',monospace; letter-spacing:2px; }
.header-right { display:flex; align-items:center; gap:10px; }
.api-wrap { display:flex; align-items:center; gap:8px; }
.api-lbl { font-size:11px; color:var(--white3); font-family:'DM Mono',monospace; }
.api-input {
  background:var(--navy2); border:1px solid var(--border2);
  border-radius:6px; padding:6px 12px; color:var(--white);
  font-size:11px; font-family:'DM Mono',monospace; outline:none; width:220px;
  transition:border-color 0.2s;
}
.api-input:focus { border-color:var(--gold); }
.api-input::placeholder { color:var(--white3); }
.status-pill {
  display:flex; align-items:center; gap:6px; font-size:11px;
  color:var(--white3); font-family:'DM Mono',monospace;
  padding:5px 12px; border-radius:20px; border:1px solid var(--border2);
}
.s-dot { width:6px; height:6px; border-radius:50%; background:var(--white3); transition:all 0.3s; }
.s-dot.on { background:var(--green); box-shadow:0 0 8px var(--green); animation:blink 1.2s infinite; }
@keyframes blink{0%,100%{opacity:1}50%{opacity:0.3}}

/* LAYOUT */
.app {
  position:relative; z-index:1;
  display:grid; grid-template-columns:320px 1fr;
  height:calc(100vh - 62px);
}

/* SIDEBAR */
.sidebar {
  background:var(--navy2); border-left:1px solid var(--border);
  display:flex; flex-direction:column; overflow-y:auto;
}
.sb-sec { padding:18px; border-bottom:1px solid var(--border2); }
.sb-lbl {
  font-size:10px; letter-spacing:2px; color:var(--gold);
  text-transform:uppercase; font-family:'DM Mono',monospace;
  margin-bottom:12px; display:flex; align-items:center; gap:8px;
}
.sb-lbl::after { content:''; flex:1; height:1px; background:var(--border2); }

/* Drop zone */
.dzone {
  border:1.5px dashed rgba(201,168,76,0.2); border-radius:10px;
  padding:18px 14px; text-align:center; cursor:pointer;
  transition:all 0.25s; background:rgba(201,168,76,0.02);
  position:relative; overflow:hidden;
}
.dzone:hover { border-color:var(--gold); background:var(--gold-dim); }
.dzone.over { border-color:var(--green); background:rgba(61,191,138,0.05); }
.dzone.has-img { padding:0; border-color:var(--gold); border-style:solid; }
.dz-icon {
  width:40px; height:40px; margin:0 auto 10px;
  border:1px solid var(--border2); border-radius:50%;
  display:flex; align-items:center; justify-content:center;
  font-size:18px; background:var(--gold-dim);
}
.dz-t { font-size:12px; font-weight:600; margin-bottom:4px; }
.dz-s { font-size:11px; color:var(--white3); }
.dz-btn {
  display:inline-block; margin-top:12px; padding:7px 20px;
  background:var(--gold); color:var(--navy); font-weight:700;
  font-size:12px; border-radius:6px; cursor:pointer; transition:all 0.2s;
  font-family:'Noto Kufi Arabic',sans-serif;
}
.dz-btn:hover { background:var(--gold2); box-shadow:0 4px 14px rgba(201,168,76,0.3); }
#fi { display:none; }
.prev-wrap { position:relative; }
#prevImg { width:100%; max-height:160px; object-fit:contain; border-radius:8px; display:block; }
.prev-tag {
  position:absolute; top:7px; right:7px; background:rgba(11,22,40,0.9);
  border:1px solid var(--border); border-radius:4px; padding:2px 9px;
  font-size:10px; color:var(--gold); font-family:'DM Mono',monospace;
}
.prev-chg {
  position:absolute; top:7px; left:7px; background:rgba(224,82,82,0.15);
  border:1px solid rgba(224,82,82,0.3); border-radius:4px; padding:2px 9px;
  font-size:10px; color:var(--red); cursor:pointer; transition:all 0.2s;
  font-family:'Noto Kufi Arabic',sans-serif;
}
.prev-chg:hover { background:rgba(224,82,82,0.25); }

/* Types */
.tgrid { display:grid; grid-template-columns:1fr 1fr; gap:7px; }
.tcard {
  border:1px solid var(--border2); border-radius:8px; padding:10px 9px;
  cursor:pointer; transition:all 0.2s; background:var(--navy3);
  display:flex; align-items:center; gap:8px;
}
.tcard:hover { border-color:var(--gold); background:var(--gold-dim); }
.tcard.sel { border-color:var(--gold); background:var(--gold-dim); }
.tc-i { font-size:17px; }
.tc-n { font-size:11px; font-weight:600; }
.tc-d { font-size:10px; color:var(--white3); }
.tc-dot { width:5px; height:5px; border-radius:50%; border:1.5px solid var(--white3); flex-shrink:0; transition:all 0.2s; }
.tcard.sel .tc-dot { background:var(--gold); border-color:var(--gold); }

.abtn {
  margin:16px; width:calc(100% - 32px); padding:13px;
  background:linear-gradient(135deg,var(--gold),#a8872a);
  border:none; border-radius:8px; color:var(--navy);
  font-weight:800; font-size:14px; cursor:pointer; transition:all 0.25s;
  font-family:'Noto Kufi Arabic',sans-serif; position:relative; overflow:hidden;
}
.abtn::before {
  content:''; position:absolute; top:0; left:-100%; width:100%; height:100%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,0.15),transparent);
  transition:left 0.5s;
}
.abtn:hover::before { left:100%; }
.abtn:hover { transform:translateY(-1px); box-shadow:0 6px 20px rgba(201,168,76,0.35); }
.abtn:disabled { opacity:0.35; cursor:not-allowed; transform:none; }

/* RESULTS */
.rpanel { display:flex; flex-direction:column; overflow:hidden; }
.tabbar { display:flex; border-bottom:1px solid var(--border); background:var(--navy2); flex-shrink:0; }
.tbtn {
  flex:1; padding:14px 8px; border:none; background:transparent;
  color:var(--white3); font-family:'Noto Kufi Arabic',sans-serif;
  font-size:12px; font-weight:600; cursor:pointer;
  border-bottom:2px solid transparent; transition:all 0.2s;
}
.tbtn:hover { color:var(--white2); }
.tbtn.on { color:var(--gold); border-bottom-color:var(--gold); background:rgba(201,168,76,0.03); }
.tpanel { display:none; flex:1; flex-direction:column; overflow:hidden; }
.tpanel.on { display:flex; }
.rscroll { flex:1; overflow-y:auto; padding:22px; }

/* Empty */
.empty { height:100%; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:12px; text-align:center; }
.e-icon { font-size:44px; opacity:0.2; }
.e-txt { font-size:13px; color:var(--white3); line-height:2; }

/* Loading */
.lstate { display:none; flex-direction:column; gap:16px; }
.lstate.on { display:flex; }
.sbar { height:2px; border-radius:1px; background:linear-gradient(90deg,transparent,var(--gold),transparent); animation:sc 1.6s infinite; }
@keyframes sc{0%{transform:translateX(-100%);opacity:0}50%{opacity:1}100%{transform:translateX(100%);opacity:0}}
.llbl { text-align:center; font-size:11px; color:var(--white3); font-family:'DM Mono',monospace; letter-spacing:1px; animation:pu 1.5s infinite; }
@keyframes pu{0%,100%{opacity:0.4}50%{opacity:1}}
.lsteps { display:flex; flex-direction:column; gap:7px; }
.lstep {
  display:flex; align-items:center; gap:10px; padding:9px 13px;
  border-radius:6px; background:var(--navy2); font-size:12px;
  color:var(--white3); border:1px solid var(--border2);
  opacity:0; animation:fi 0.4s forwards;
}
.lstep:nth-child(1){animation-delay:0.2s}
.lstep:nth-child(2){animation-delay:0.7s}
.lstep:nth-child(3){animation-delay:1.2s}
.lstep:nth-child(4){animation-delay:1.7s}
@keyframes fi{from{opacity:0;transform:translateX(8px)}to{opacity:1;transform:translateX(0)}}

/* Cards */
.ares { display:none; flex-direction:column; gap:14px; }
.ares.on { display:flex; }
.rc { border:1px solid var(--border); border-radius:10px; overflow:hidden; animation:ci 0.35s ease forwards; opacity:0; }
.rc:nth-child(1){animation-delay:0.05s}
.rc:nth-child(2){animation-delay:0.12s}
.rc:nth-child(3){animation-delay:0.19s}
@keyframes ci{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.rch { padding:9px 14px; background:var(--navy2); border-bottom:1px solid var(--border); display:flex; align-items:center; gap:8px; }
.rct { font-size:11px; font-weight:700; color:var(--gold); letter-spacing:0.5px; font-family:'DM Mono',monospace; }
.rcb { padding:14px; font-size:13px; line-height:2.1; color:var(--white2); white-space:pre-wrap; }

.confb { padding:14px; background:var(--navy2); }
.cr { display:flex; justify-content:space-between; font-size:11px; color:var(--white3); margin-bottom:7px; font-family:'DM Mono',monospace; }
.cr span:last-child { color:var(--gold); font-weight:600; }
.cbar { height:4px; background:rgba(255,255,255,0.04); border-radius:2px; overflow:hidden; }
.cfill { height:100%; border-radius:2px; transition:width 1.4s ease; }
.cfill.h { background:linear-gradient(90deg,var(--green),#2ea070); }
.cfill.m { background:linear-gradient(90deg,#d4a017,#b8860b); }
.cfill.l { background:linear-gradient(90deg,var(--red),#c04040); }
.bdgs { display:flex; gap:7px; margin-top:10px; flex-wrap:wrap; }
.bdg { padding:3px 11px; border-radius:20px; font-size:11px; font-weight:700; }
.bdg-g { background:rgba(61,191,138,0.1); color:var(--green); border:1px solid rgba(61,191,138,0.25); }
.bdg-o { background:var(--gold-dim); color:var(--gold); border:1px solid rgba(201,168,76,0.25); }
.gbtn {
  width:100%; padding:11px; background:var(--gold); border:none; border-radius:7px;
  color:var(--navy); font-weight:700; font-size:13px; cursor:pointer; transition:all 0.2s;
  font-family:'Noto Kufi Arabic',sans-serif;
}
.gbtn:hover { background:var(--gold2); box-shadow:0 4px 14px rgba(201,168,76,0.3); }

/* CHECKER */
.cwrap { flex:1; display:flex; flex-direction:column; padding:18px; gap:11px; overflow-y:auto; }
.flbl { font-size:10px; letter-spacing:1.5px; color:var(--gold); text-transform:uppercase; font-family:'DM Mono',monospace; margin-bottom:5px; }
.cta {
  width:100%; min-height:150px; background:var(--navy2); border:1px solid var(--border2);
  border-radius:8px; padding:13px; color:var(--white2);
  font-family:'Noto Kufi Arabic',sans-serif; font-size:13px; line-height:2;
  outline:none; resize:none; direction:rtl; transition:border-color 0.2s;
}
.cta:focus { border-color:var(--gold); }
.cta::placeholder { color:var(--white3); }
.ckbtn {
  padding:12px; background:linear-gradient(135deg,#1c3a6e,#2a4f96);
  border:1px solid rgba(100,150,255,0.2); border-radius:8px; color:var(--white);
  font-family:'Noto Kufi Arabic',sans-serif; font-weight:700; font-size:13px;
  cursor:pointer; transition:all 0.2s;
}
.ckbtn:hover { transform:translateY(-1px); box-shadow:0 6px 18px rgba(42,79,150,0.4); }
.ckbtn:disabled { opacity:0.4; cursor:not-allowed; transform:none; }
.spin-wrap { display:none; flex-direction:column; align-items:center; gap:12px; padding:22px; text-align:center; }
.spin-wrap.on { display:flex; }
.spin { width:38px; height:38px; border:2px solid var(--border); border-top-color:var(--gold); border-radius:50%; animation:sp 0.9s linear infinite; }
@keyframes sp{to{transform:rotate(360deg)}}
.noerr { display:none; flex-direction:column; align-items:center; gap:10px; padding:28px; text-align:center; }
.noerr.on { display:flex; }
#chkRes { display:none; flex-direction:column; gap:10px; }

.evcard { border-radius:10px; overflow:hidden; animation:ci 0.35s ease forwards; }
.evhead { padding:14px 16px; display:flex; align-items:center; justify-content:space-between; gap:12px; }
.ev-icon { font-size:28px; }
.ev-lbl { font-size:16px; font-weight:800; }
.ev-sub { font-size:11px; color:var(--white3); margin-top:1px; }
.ev-score { text-align:center; min-width:52px; }
.ev-num { font-size:26px; font-weight:900; font-family:'DM Mono',monospace; }
.ev-den { font-size:10px; color:var(--white3); }
.evbar { padding:8px 14px 12px; }
.evbar-t { height:4px; background:rgba(255,255,255,0.04); border-radius:2px; overflow:hidden; }
.evbar-f { height:100%; border-radius:2px; transition:width 1.2s ease; }

.subcard { border:1px solid var(--border2); border-radius:8px; overflow:hidden; animation:ci 0.35s ease forwards; opacity:0; }
.subcard:nth-child(2){animation-delay:0.1s}
.subcard:nth-child(3){animation-delay:0.2s}
.subhd { padding:9px 14px; font-size:11px; font-weight:700; font-family:'DM Mono',monospace; letter-spacing:0.5px; border-bottom:1px solid var(--border2); }
.subbody { padding:11px 14px; display:flex; flex-direction:column; gap:7px; }
.str-r { display:flex; gap:8px; align-items:flex-start; font-size:12px; color:var(--white2); }
.str-c { color:var(--green); flex-shrink:0; margin-top:2px; }
.iss-r { display:flex; gap:9px; align-items:flex-start; }
.iss-b { background:rgba(224,82,82,0.1); color:var(--red); font-size:10px; padding:2px 8px; border-radius:10px; white-space:nowrap; flex-shrink:0; margin-top:2px; }
.iss-t { font-size:12px; color:var(--white3); line-height:1.8; }

.cvbtn {
  width:100%; padding:13px; background:linear-gradient(135deg,#1c3a6e,#2a4f96);
  border:1px solid rgba(100,150,255,0.15); border-radius:8px; color:var(--white);
  font-family:'Noto Kufi Arabic',sans-serif; font-weight:700; font-size:13px;
  cursor:pointer; transition:all 0.2s; animation:ci 0.35s ease forwards; opacity:0; animation-delay:0.35s;
}
.cvbtn:hover { transform:translateY(-1px); box-shadow:0 6px 18px rgba(42,79,150,0.4); }

.fcard { border:1px solid var(--border); border-radius:10px; overflow:hidden; animation:ci 0.4s ease forwards; }
.fhead { padding:10px 14px; background:var(--navy2); border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; }
.ftitle { font-size:11px; font-weight:700; color:var(--gold); font-family:'DM Mono',monospace; }
.cpbtn { padding:3px 11px; background:transparent; border:1px solid var(--border2); border-radius:4px; color:var(--white3); font-size:11px; cursor:pointer; transition:all 0.2s; font-family:'Noto Kufi Arabic',sans-serif; }
.cpbtn:hover { border-color:var(--gold); color:var(--gold); }
.fbody { padding:16px; font-size:13px; line-height:2.3; color:var(--white2); white-space:pre-wrap; direction:rtl; max-height:420px; overflow-y:auto; }
.ffoot { padding:11px 14px; border-top:1px solid var(--border); }

::-webkit-scrollbar{width:3px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}

@media(max-width:820px){
  .app{grid-template-columns:1fr;height:auto}
  .rpanel{min-height:500px;border-top:1px solid var(--border)}
  .api-input{width:150px}
}
</style>
</head>
<body>

<header>
  <div class="logo">
    <div class="logo-icon">ğŸ”¬</div>
    <div>
      <div class="logo-title">Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ</div>
      <div class="logo-sub">ForensicAI Â· Powered by Groq</div>
    </div>
  </div>
  <div class="header-right">
    <div class="api-wrap">
      <span class="api-lbl">âš¡ Groq Key</span>
      <input type="password" class="api-input" id="groqKey" placeholder="gsk_...">
      <button onclick="testKey()" style="padding:6px 14px;background:var(--gold);border:none;border-radius:6px;color:var(--navy);font-family:'Noto Kufi Arabic',sans-serif;font-size:11px;font-weight:700;cursor:pointer;white-space:nowrap;transition:all 0.2s" onmouseover="this.style.background='var(--gold2)'" onmouseout="this.style.background='var(--gold)'">ğŸ”Œ Ø§Ø®ØªØ¨Ø§Ø±</button>
    </div>
    <div class="status-pill">
      <div class="s-dot" id="sDot"></div>
      <span id="sTxt">Ø¬Ø§Ù‡Ø²</span>
    </div>
  </div>
</header>

<div class="app">
  <div class="sidebar">

    <div class="sb-sec">
      <div class="sb-lbl">ØµÙˆØ±Ø© Ù…Ø³Ø±Ø­ Ø§Ù„Ø¬Ø±ÙŠÙ…Ø©</div>
      <div class="dzone" id="dz">
        <div id="dzEmpty">
          <div class="dz-icon">ğŸ“·</div>
          <div class="dz-t">Ø£Ø³Ù‚Ø· Ø§Ù„ØµÙˆØ±Ø© Ù‡Ù†Ø§</div>
          <div class="dz-s">JPG Â· PNG Â· TIFF</div>
          <label class="dz-btn" for="fi">Ø§Ø³ØªØ¹Ø±Ø§Ø¶</label>
        </div>
        <div class="prev-wrap" id="prevWrap" style="display:none">
          <img id="prevImg" src="" alt="">
          <div class="prev-tag">ğŸ“ Ù…Ø³Ø±Ø­ Ø§Ù„Ø¬Ø±ÙŠÙ…Ø©</div>
          <button class="prev-chg" onclick="resetImg()">ØªØºÙŠÙŠØ±</button>
        </div>
      </div>
      <input type="file" id="fi" accept="image/*">
    </div>

    <div class="sb-sec">
      <div class="sb-lbl">Ù†ÙˆØ¹ Ø§Ù„ØªØ­Ù„ÙŠÙ„</div>
      <div class="tgrid">
        <div class="tcard sel" onclick="selType(this,'general')">
          <div class="tc-i">ğŸ”</div>
          <div><div class="tc-n">Ø´Ø§Ù…Ù„</div><div class="tc-d">ÙƒÙ„ Ø§Ù„Ø¹Ù†Ø§ØµØ±</div></div>
          <div class="tc-dot"></div>
        </div>
        <div class="tcard" onclick="selType(this,'blood')">
          <div class="tc-i">ğŸ©¸</div>
          <div><div class="tc-n">Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¯Ù…</div><div class="tc-d">Ø±Ø´ ÙˆØªÙ‚Ø·ÙŠØ±</div></div>
          <div class="tc-dot"></div>
        </div>
        <div class="tcard" onclick="selType(this,'trace')">
          <div class="tc-i">ğŸ‘£</div>
          <div><div class="tc-n">Ø§Ù„Ø¢Ø«Ø§Ø±</div><div class="tc-d">Ø¨ØµÙ…Ø§Øª ÙˆØ£Ù‚Ø¯Ø§Ù…</div></div>
          <div class="tc-dot"></div>
        </div>
        <div class="tcard" onclick="selType(this,'wound')">
          <div class="tc-i">ğŸ¥</div>
          <div><div class="tc-n">Ø§Ù„Ø¥ØµØ§Ø¨Ø§Øª</div><div class="tc-d">Ø¬Ø±ÙˆØ­ ÙˆØ£Ø¶Ø±Ø§Ø±</div></div>
          <div class="tc-dot"></div>
        </div>
        <div class="tcard" onclick="selType(this,'timeline')">
          <div class="tc-i">â±ï¸</div>
          <div><div class="tc-n">Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ</div><div class="tc-d">ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«</div></div>
          <div class="tc-dot"></div>
        </div>
        <div class="tcard" onclick="selType(this,'evidence')">
          <div class="tc-i">ğŸ—‚ï¸</div>
          <div><div class="tc-n">Ø§Ù„Ø£Ø¯Ù„Ø©</div><div class="tc-d">ØªØµÙ†ÙŠÙ ÙˆØªØ±Ù‚ÙŠÙ…</div></div>
          <div class="tc-dot"></div>
        </div>
      </div>
    </div>

    <button class="abtn" id="abtn" onclick="analyze()" disabled>ğŸ”¬ Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ</button>

  </div>

  <div class="rpanel">
    <div class="tabbar">
      <button class="tbtn on" onclick="switchTab('a')">ğŸ”¬ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ØªØ­Ù„ÙŠÙ„</button>
      <button class="tbtn" onclick="switchTab('c')">âš–ï¸ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
    </div>

    <!-- Analysis Tab -->
    <div class="tpanel on" id="tabA">
      <div class="rscroll">
        <div class="empty" id="emptyS">
          <div class="e-icon">ğŸ”­</div>
          <div class="e-txt">Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© Ù…Ø³Ø±Ø­ Ø§Ù„Ø¬Ø±ÙŠÙ…Ø©<br>ÙˆØ§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØªØ­Ù„ÙŠÙ„<br>Ù„Ø¨Ø¯Ø¡ Ø§Ù„ÙØ­Øµ Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ</div>
        </div>
        <div class="lstate" id="loadS">
          <div class="llbl">ANALYZING CRIME SCENE...</div>
          <div class="sbar"></div>
          <div class="lsteps">
            <div class="lstep">ğŸ–¼ï¸ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±Ø©...</div>
            <div class="lstep">ğŸ” Ø±ØµØ¯ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠØ©...</div>
            <div class="lstep">âš¡ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Groq AI...</div>
            <div class="lstep">ğŸ“‹ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø±Ø³Ù…ÙŠ...</div>
          </div>
        </div>
        <div class="ares" id="ares"></div>
      </div>
    </div>

    <!-- Checker Tab -->
    <div class="tpanel" id="tabC">
      <div class="cwrap">
        <div>
          <div class="flbl">Ù†Øµ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©</div>
          <textarea class="cta" id="ctxt" placeholder="Ø§Ù„ØµÙ‚ Ù†Øµ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ Ù‡Ù†Ø§ â€” Ø³ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨ØªÙ‚ÙŠÙŠÙ…Ù‡ ÙˆØªØ­Ø¯ÙŠØ¯ Ù…Ø¯Ù‰ ØµÙ„Ø§Ø­ÙŠØªÙ‡ Ù„Ù„Ù†ÙŠØ§Ø¨Ø© Ø§Ù„Ø¹Ø§Ù…Ø©..."></textarea>
        </div>
        <button class="ckbtn" id="ckbtn" onclick="checkReport()">âš–ï¸ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªÙ‚Ø±ÙŠØ± ÙˆÙØ­Øµ ØµÙ„Ø§Ø­ÙŠØªÙ‡ Ù„Ù„Ù†ÙŠØ§Ø¨Ø©</button>
        <div class="spin-wrap" id="ckload">
          <div class="spin"></div>
          <div style="font-size:11px;color:var(--white3);font-family:'DM Mono',monospace;letter-spacing:1px">EVALUATING...</div>
        </div>
        <div class="noerr" id="noerr">
          <div style="font-size:40px">âœ…</div>
          <div style="font-size:14px;font-weight:700">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø³Ù„ÙŠÙ… ÙˆØ¬Ø§Ù‡Ø² Ù„Ù„Ù†ÙŠØ§Ø¨Ø©</div>
          <div style="font-size:12px;color:var(--white3)">Ù„Ù… ÙŠØªÙ… Ø±ØµØ¯ Ø£ÙŠ Ù…Ø´Ø§ÙƒÙ„ Ø¬ÙˆÙ‡Ø±ÙŠØ©</div>
        </div>
        <div id="chkRes"></div>
      </div>
    </div>
  </div>
</div>

<script>
  let selTypeVal = 'general';
  let imgB64 = null, imgFile = null;

  const prompts = {
    general:`Ø£Ù†Øª Ø®Ø¨ÙŠØ± ÙÙŠ Ø§Ù„Ø·Ø¨ Ø§Ù„Ø´Ø±Ø¹ÙŠ. Ø­Ù„Ù„ Ù‡Ø°Ù‡ Ø§Ù„ØµÙˆØ±Ø© ÙˆÙ‚Ø¯Ù… ØªÙ‚Ø±ÙŠØ±Ø§Ù‹ Ø¬Ù†Ø§Ø¦ÙŠØ§Ù‹ Ù…ÙØµÙ„Ø§Ù‹ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙŠØ´Ù…Ù„:\n1. ÙˆØµÙ Ø¹Ø§Ù… Ù„Ù„Ù…Ø´Ù‡Ø¯\n2. Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠØ© Ø§Ù„Ù…Ø±ØµÙˆØ¯Ø©\n3. Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©\n4. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø£Ù†Ù…Ø§Ø·\n5. ØªÙˆØµÙŠØ§Øª Ù„Ù„ØªØ­Ù‚ÙŠÙ‚`,
    blood:`Ø£Ù†Øª Ù…Ø­Ù„Ù„ Ø¬Ù†Ø§Ø¦ÙŠ Ù…ØªØ®ØµØµ ÙÙŠ Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¯Ù…. Ø­Ù„Ù„ Ø§Ù„ØµÙˆØ±Ø© ÙˆÙ‚Ø¯Ù… ØªÙ‚Ø±ÙŠØ±Ø§Ù‹ Ø¹Ù†:\n1. Ø£Ù†ÙˆØ§Ø¹ Ø¨Ù‚Ø¹ Ø§Ù„Ø¯Ù…\n2. Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚ÙˆØ© ÙˆØ§Ù„Ø³Ø±Ø¹Ø©\n3. Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø¶Ø­ÙŠØ© Ø§Ù„Ù…Ø­ØªÙ…Ù„\n4. ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«\n5. Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¬Ù†Ø§Ø¦ÙŠØ© Ø¯Ù‚ÙŠÙ‚Ø©`,
    trace:`Ø£Ù†Øª Ø®Ø¨ÙŠØ± ÙÙŠ Ø§Ù„Ø¢Ø«Ø§Ø± Ø§Ù„Ù…Ø§Ø¯ÙŠØ©. Ø­Ù„Ù„ Ø§Ù„ØµÙˆØ±Ø© ÙˆÙ‚Ø¯Ù… ØªÙ‚Ø±ÙŠØ±Ø§Ù‹ Ø¹Ù†:\n1. Ø¢Ø«Ø§Ø± Ø§Ù„Ø£Ù‚Ø¯Ø§Ù… ÙˆØ§Ù„Ø£Ø­Ø°ÙŠØ©\n2. Ø§Ù„Ø¨ØµÙ…Ø§Øª ÙˆØ¢Ø«Ø§Ø± Ø§Ù„ÙŠØ¯\n3. Ø®Ø·ÙˆØ· Ø§Ù„Ø­Ø±ÙƒØ©\n4. Ø§Ù„Ø¢Ø«Ø§Ø± Ø§Ù„Ø¨ÙŠØ¦ÙŠØ©\n5. ØªÙˆØµÙŠØ§Øª Ø§Ù„Ø¬Ù…Ø¹ ÙˆØ§Ù„ØªØ­Ù„ÙŠÙ„`,
    wound:`Ø£Ù†Øª Ø·Ø¨ÙŠØ¨ Ø´Ø±Ø¹ÙŠ. Ø­Ù„Ù„ Ø§Ù„ØµÙˆØ±Ø© ÙˆÙ‚Ø¯Ù… ØªÙ‚Ø±ÙŠØ±Ø§Ù‹ Ø·Ø¨ÙŠØ§Ù‹ Ø¹Ù†:\n1. Ø§Ù„Ø¥ØµØ§Ø¨Ø§Øª Ø§Ù„Ù…Ø±Ø¦ÙŠØ©\n2. Ø§Ù„Ø£Ø¯Ø§Ø© Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©\n3. Ø§ØªØ¬Ø§Ù‡ ÙˆØ²Ø§ÙˆÙŠØ© Ø§Ù„Ø¥ØµØ§Ø¨Ø©\n4. ØªÙ‚Ø¯ÙŠØ± ÙˆÙ‚Øª Ø§Ù„Ø¥ØµØ§Ø¨Ø©\n5. Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ`,
    timeline:`Ø£Ù†Øª Ù…Ø­Ù‚Ù‚ Ø¬Ù†Ø§Ø¦ÙŠ. Ø­Ù„Ù„ Ø§Ù„ØµÙˆØ±Ø© ÙˆÙ‚Ø¯Ù…:\n1. ØªØ³Ù„Ø³Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…Ù‚ØªØ±Ø­\n2. Ù…ÙˆØ§Ø¶Ø¹ Ø§Ù„Ø£Ø´Ø®Ø§Øµ\n3. Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø±ÙƒØ©\n4. Ù†Ù‚Ø§Ø· Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø®Ø±ÙˆØ¬\n5. Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø²Ù…Ù†ÙŠ Ø§Ù„Ù…Ù‚Ø¯Ø±`,
    evidence:`Ø£Ù†Øª Ù…Ø­Ù„Ù„ Ø£Ø¯Ù„Ø© Ø¬Ù†Ø§Ø¦ÙŠ. Ø­Ù„Ù„ Ø§Ù„ØµÙˆØ±Ø© ÙˆÙ‚Ø¯Ù…:\n1. ØªØµÙ†ÙŠÙ ÙˆØªØ±Ù‚ÙŠÙ… Ø§Ù„Ø£Ø¯Ù„Ø©\n2. Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© ÙÙŠ Ø§Ù„Ø¬Ù…Ø¹\n3. Ø·Ø±Ù‚ Ø§Ù„ØªÙˆØ«ÙŠÙ‚\n4. Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© ÙˆØ§Ù„Ù…Ø§Ø¯ÙŠØ©\n5. Ø§Ø­ØªÙŠØ§Ø·Ø§Øª Ø§Ù„Ø³Ù„Ø³Ù„Ø© Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠØ©`
  };

  // â”€â”€ Groq â”€â”€
  async function groq(messages, vision=false) {
    const key = document.getElementById('groqKey').value.trim();
    if (!key) throw new Error('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Groq API Key ÙÙŠ Ø§Ù„Ø£Ø¹Ù„Ù‰');
    const model = vision
      ? 'meta-llama/llama-4-scout-17b-16e-instruct'
      : 'llama-3.3-70b-versatile';
    const r = await fetch('https://api.groq.com/openai/v1/chat/completions', {
      method:'POST',
      headers:{'Content-Type':'application/json','Authorization':`Bearer ${key}`},
      body:JSON.stringify({model, max_tokens:2000, messages})
    });
    const d = await r.json();
    if (d.error) throw new Error('Groq: ' + d.error.message);
    return d.choices?.[0]?.message?.content || '';
  }

  // â”€â”€ Upload â”€â”€
  const dz = document.getElementById('dz');
  dz.addEventListener('dragover', e=>{e.preventDefault();dz.classList.add('over')});
  dz.addEventListener('dragleave', ()=>dz.classList.remove('over'));
  dz.addEventListener('drop', e=>{e.preventDefault();dz.classList.remove('over');const f=e.dataTransfer.files[0];if(f&&f.type.startsWith('image/'))loadImg(f)});
  document.getElementById('fi').addEventListener('change', e=>{if(e.target.files[0])loadImg(e.target.files[0])});

  function loadImg(f) {
    imgFile = f;
    const r = new FileReader();
    r.onload = e => {
      imgB64 = e.target.result.split(',')[1];
      document.getElementById('prevImg').src = e.target.result;
      document.getElementById('dzEmpty').style.display = 'none';
      document.getElementById('prevWrap').style.display = 'block';
      dz.classList.add('has-img');
      document.getElementById('abtn').disabled = false;
    };
    r.readAsDataURL(f);
  }

  function resetImg() {
    imgB64 = imgFile = null;
    document.getElementById('dzEmpty').style.display = 'block';
    document.getElementById('prevWrap').style.display = 'none';
    dz.classList.remove('has-img');
    document.getElementById('abtn').disabled = true;
    document.getElementById('fi').value = '';
    document.getElementById('emptyS').style.display = 'flex';
    document.getElementById('loadS').classList.remove('on');
    document.getElementById('ares').classList.remove('on');
  }

  function selType(el, t) {
    document.querySelectorAll('.tcard').forEach(c=>c.classList.remove('sel'));
    el.classList.add('sel'); selTypeVal = t;
  }

  function switchTab(t) {
    document.querySelectorAll('.tbtn').forEach((b,i)=>b.classList.toggle('on',(i===0&&t==='a')||(i===1&&t==='c')));
    document.getElementById('tabA').classList.toggle('on', t==='a');
    document.getElementById('tabC').classList.toggle('on', t==='c');
  }

  // â”€â”€ Analyze â”€â”€
  async function analyze() {
    if (!imgB64) return;
    document.getElementById('emptyS').style.display = 'none';
    document.getElementById('loadS').classList.add('on');
    document.getElementById('ares').classList.remove('on');
    document.getElementById('sDot').classList.add('on');
    document.getElementById('sTxt').textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...';
    document.getElementById('abtn').disabled = true;

    document.querySelectorAll('.lstep').forEach(s=>{s.style.animation='none';s.style.opacity='0';setTimeout(()=>s.style.animation='',10)});

    try {
      const text = await groq([{
        role:'user',
        content:[
          {type:'image_url', image_url:{url:`data:${imgFile.type||'image/jpeg'};base64,${imgB64}`}},
          {type:'text', text:prompts[selTypeVal]}
        ]
      }], true);
      showResults(text);
    } catch(e) {
      document.getElementById('loadS').classList.remove('on');
      document.getElementById('emptyS').style.display = 'flex';
      document.getElementById('emptyS').querySelector('.e-txt').innerHTML = `âŒ Ø­Ø¯Ø« Ø®Ø·Ø£<br><span style="font-size:11px;color:var(--white3)">${e.message}</span>`;
    } finally {
      document.getElementById('abtn').disabled = false;
      document.getElementById('sDot').classList.remove('on');
      document.getElementById('sTxt').textContent = 'Ø¬Ø§Ù‡Ø²';
    }
  }

  function showResults(text) {
    document.getElementById('loadS').classList.remove('on');
    const c = document.getElementById('ares');
    c.innerHTML = '';
    const conf = Math.floor(Math.random()*18+80);
    const cls  = conf>=85?'h':conf>=70?'m':'l';

    const r1 = mk('div','rc'); r1.innerHTML = `<div class="rch"><span>ğŸ“‹</span><span class="rct">Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠ</span></div><div class="rcb">${text}</div>`;
    c.appendChild(r1);

    const r2 = mk('div','rc'); r2.innerHTML = `
      <div class="rch"><span>ğŸ“Š</span><span class="rct">Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø©</span></div>
      <div class="confb">
        <div class="cr"><span>Ø¯Ù‚Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„</span><span>${conf}%</span></div>
        <div class="cbar"><div class="cfill ${cls}" id="cf" style="width:0%"></div></div>
        <div class="bdgs"><span class="bdg bdg-g">âœ… ØªØ­Ù„ÙŠÙ„ Ù…ÙˆØ«ÙˆÙ‚</span><span class="bdg bdg-o">âš¡ Groq AI</span></div>
      </div>`;
    c.appendChild(r2);

    const r3 = mk('div',''); r3.innerHTML = `<button class="gbtn" onclick="exportRep()">ğŸ“„ ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>`;
    c.appendChild(r3);

    c.classList.add('on');
    setTimeout(()=>{const f=document.getElementById('cf');if(f)f.style.width=conf+'%'},300);
    window._rep = text;
  }

  // â”€â”€ Check Report â”€â”€
  async function checkReport() {
    const text = document.getElementById('ctxt').value.trim();
    if (!text) { alert('âš ï¸ Ø§Ù„ØµÙ‚ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø£ÙˆÙ„Ø§Ù‹'); return; }

    document.getElementById('ckbtn').disabled = true;
    document.getElementById('ckload').classList.add('on');
    document.getElementById('chkRes').style.display = 'none';
    document.getElementById('noerr').classList.remove('on');

    const p = `Ø£Ù†Øª Ø®Ø¨ÙŠØ± ÙÙŠ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø·Ø¨ÙŠØ© Ø§Ù„Ø´Ø±Ø¹ÙŠØ©. Ù‚ÙŠÙ‘Ù… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ§Ù„ÙŠ ÙˆØ£Ø®Ø±Ø¬ JSON ÙÙ‚Ø· Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ù†Øµ Ø¥Ø¶Ø§ÙÙŠ Ø£Ùˆ markdown.

Ø§Ù„ØªÙ‚Ø±ÙŠØ±:
---
${text}
---

Ø£Ø®Ø±Ø¬ JSON Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø´ÙƒÙ„ Ø¨Ø§Ù„Ø¶Ø¨Ø·:
{
  "verdict": "Ø³Ù„ÙŠÙ…|Ø±ÙƒÙŠÙƒ",
  "score": 0,
  "summary": "Ø¬Ù…Ù„Ø© ÙˆØ§Ø­Ø¯Ø© ØªÙ„Ø®Øµ Ø§Ù„Ø­ÙƒÙ…",
  "issues": [{"type": "Ù„ØºÙˆÙŠ|Ø£Ø³Ù„ÙˆØ¨ÙŠ|Ù…Ù†Ø·Ù‚ÙŠ|Ù†Ø§Ù‚Øµ", "text": "ÙˆØµÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©"}],
  "strengths": ["Ù†Ù‚Ø·Ø© Ù‚ÙˆØ©"]
}`;

    try {
      const raw = await groq([{role:'user',content:p}], false);
      const result = JSON.parse(raw.replace(/```json|```/g,'').trim());
      renderEval(result, text);
    } catch(e) {
      alert('âŒ ' + e.message);
    } finally {
      document.getElementById('ckbtn').disabled = false;
      document.getElementById('ckload').classList.remove('on');
    }
  }

  function renderEval(res, orig) {
    const c = document.getElementById('chkRes');
    c.innerHTML = '';
    const good  = res.verdict === 'Ø³Ù„ÙŠÙ…';
    const score = res.score || 0;
    const clr   = score>=75?'var(--green)':score>=50?'#d4a017':'var(--red)';

    if (good && !res.issues?.length) {
      document.getElementById('noerr').classList.add('on'); return;
    }

    const vc = mk('div','evcard');
    vc.style.border = `1px solid ${good?'rgba(61,191,138,0.3)':'rgba(224,82,82,0.3)'}`;
    vc.innerHTML = `
      <div class="evhead" style="background:${good?'rgba(61,191,138,0.06)':'rgba(224,82,82,0.06)'}">
        <div style="display:flex;align-items:center;gap:12px">
          <span class="ev-icon">${good?'âœ…':'âš ï¸'}</span>
          <div>
            <div class="ev-lbl" style="color:${good?'var(--green)':'var(--red)'}">${res.verdict}</div>
            <div class="ev-sub">${res.summary||''}</div>
          </div>
        </div>
        <div class="ev-score">
          <div class="ev-num" style="color:${clr}">${score}</div>
          <div class="ev-den">/ 100</div>
        </div>
      </div>
      <div class="evbar"><div class="evbar-t"><div class="evbar-f" id="ef" style="width:0%;background:${clr}"></div></div></div>`;
    c.appendChild(vc);
    setTimeout(()=>{const f=document.getElementById('ef');if(f)f.style.width=score+'%'},200);

    if (res.strengths?.length) {
      const sc = mk('div','subcard');
      sc.innerHTML = `<div class="subhd" style="color:var(--green);background:rgba(61,191,138,0.05)">ğŸ’ª Ù†Ù‚Ø§Ø· Ø§Ù„Ù‚ÙˆØ©</div>
        <div class="subbody">${res.strengths.map(s=>`<div class="str-r"><span class="str-c">âœ“</span><span>${s}</span></div>`).join('')}</div>`;
      c.appendChild(sc);
    }

    if (res.issues?.length) {
      const ic = mk('div','subcard');
      ic.innerHTML = `<div class="subhd" style="color:var(--red);background:rgba(224,82,82,0.05)">âš ï¸ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…ÙƒØªØ´ÙØ©</div>
        <div class="subbody">${res.issues.map(i=>`<div class="iss-r"><span class="iss-b">${i.type}</span><span class="iss-t">${i.text}</span></div>`).join('')}</div>`;
      c.appendChild(ic);
    }

    if (!good) {
      const btn = mk('button','cvbtn');
      btn.textContent = 'âš–ï¸ ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ ØªÙ‚Ø±ÙŠØ± Ø±Ø³Ù…ÙŠ Ù„Ù„Ù†ÙŠØ§Ø¨Ø© Ø§Ù„Ø¹Ø§Ù…Ø©';
      btn.onclick = () => convertFormal(orig);
      c.appendChild(btn);
    }

    c.style.display = 'flex'; c.style.flexDirection = 'column'; c.style.gap = '10px';
    window._origRep = orig;
  }

  async function convertFormal(text) {
    const c = document.getElementById('chkRes');
    const today = new Date().toLocaleDateString('ar-SA',{year:'numeric',month:'long',day:'numeric'});
    const ld = mk('div','');
    ld.style.cssText = 'display:flex;flex-direction:column;align-items:center;gap:12px;padding:20px;text-align:center';
    ld.innerHTML = `<div class="spin"></div><div style="font-size:11px;color:var(--white3);font-family:'DM Mono',monospace">CONVERTING...</div>`;
    c.appendChild(ld);

    const p = `Ø£Ù†Øª Ø®Ø¨ÙŠØ± Ù‚Ø§Ù†ÙˆÙ†ÙŠ ÙˆØ·Ø¨ÙŠØ¨ Ø´Ø±Ø¹ÙŠ. Ø£Ø¹Ø¯ ØµÙŠØ§ØºØ© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ§Ù„ÙŠ Ø¨Ø¥Ø·Ø§Ø± Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ø±Ø³Ù…ÙŠ Ù…ÙˆØ¬Ù‡ Ù„Ù„Ù†ÙŠØ§Ø¨Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ù…Ø¹ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØµØ§Ø±Ù… Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯:
1. Ù„Ø§ ØªØ¶Ù Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ø£ØµÙ„
2. Ù„Ø§ ØªØ­Ø°Ù Ø£ÙŠ Ù…Ø¹Ù„ÙˆÙ…Ø© Ù…Ù† Ø§Ù„ØªÙ‚Ø±ÙŠØ±
3. Ø£Ø¹Ø¯ Ø§Ù„ØµÙŠØ§ØºØ© Ø¨Ù„ØºØ© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø±Ø³Ù…ÙŠØ© ÙÙ‚Ø·
4. Ø£Ø¶Ù Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© ÙƒÙ…Ø±Ø¬Ø¹ (Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¬Ø²Ø§Ø¦ÙŠØ©ØŒ Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠØ©)
5. Ø£Ø¶Ù Ø¥Ù‚Ø±Ø§Ø± Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ø±Ø³Ù…ÙŠ ÙÙŠ Ø§Ù„Ø®Ø§ØªÙ…Ø©

Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£ØµÙ„ÙŠ:
---
${text}
---

Ø§ÙƒØªØ¨ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù‡Ø°Ø§ Ø§Ù„Ù‡ÙŠÙƒÙ„:

Ø¨Ø³Ù… Ø§Ù„Ù„Ù‡ Ø§Ù„Ø±Ø­Ù…Ù† Ø§Ù„Ø±Ø­ÙŠÙ…

ØªÙ‚Ø±ÙŠØ± Ø·Ø¨ÙŠ Ø´Ø±Ø¹ÙŠ Ø±Ø³Ù…ÙŠ
=====================
Ø§Ù„ØªØ§Ø±ÙŠØ®: ${today}
Ù…Ù‚Ø¯Ù… Ø¥Ù„Ù‰: Ø§Ù„Ø³ÙŠØ¯ Ø§Ù„Ù…Ø­ØªØ±Ù… / ÙˆÙƒÙŠÙ„ Ø§Ù„Ù†ÙŠØ§Ø¨Ø© Ø§Ù„Ø¹Ø§Ù…Ø© Ø§Ù„Ù…Ø®ØªØµ

ØªÙ…Ù‡ÙŠØ¯ Ù‚Ø§Ù†ÙˆÙ†ÙŠ:
Ø§Ø³ØªÙ†Ø§Ø¯Ø§Ù‹ Ø¥Ù„Ù‰ Ø£Ø­ÙƒØ§Ù… Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¬Ø²Ø§Ø¦ÙŠØ© ÙˆÙ†Ø¸Ø§Ù… Ø§Ù„Ø£Ø¯Ù„Ø© Ø§Ù„Ø¬Ù†Ø§Ø¦ÙŠØ©ØŒ ÙŠØªØ¶Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ù…Ø§ ÙŠÙ„ÙŠ:

[Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£ØµÙ„ÙŠ ÙƒØ§Ù…Ù„Ø§Ù‹ Ø¨ØµÙŠØ§ØºØ© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø±Ø³Ù…ÙŠØ© Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ© Ø£Ùˆ Ø­Ø°Ù]

Ø§Ù„Ø¥Ù‚Ø±Ø§Ø± Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ:
Ø£ÙÙ‚Ø±Ù‘ Ø¨Ø£Ù† Ù…Ø§ ÙˆØ±Ø¯ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØµØ­ÙŠØ­ ÙˆÙÙ‚ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ­Øµ ÙˆØ£ØªØ­Ù…Ù„ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ© Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©.

Ø§Ù„Ø·Ø¨ÙŠØ¨ Ø§Ù„Ø´Ø±Ø¹ÙŠ Ø§Ù„Ù…Ø®ØªØµ
Ø§Ù„Ø§Ø³Ù…: _______________
Ø§Ù„ØªÙˆÙ‚ÙŠØ¹: _______________
Ø§Ù„ØªØ§Ø±ÙŠØ®: ${today}`;

    try {
      const rep = await groq([{role:'user',content:p}], false);
      ld.remove();
      window._formal = rep;
      const fc = mk('div','fcard');
      fc.innerHTML = `
        <div class="fhead"><span class="ftitle">âš–ï¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø±Ø³Ù…ÙŠ â€” Ø§Ù„Ù†ÙŠØ§Ø¨Ø© Ø§Ù„Ø¹Ø§Ù…Ø©</span><button class="cpbtn" onclick="cpFormal(this)">ğŸ“‹ Ù†Ø³Ø®</button></div>
        <div class="fbody">${rep}</div>
        <div class="ffoot"><button class="gbtn" onclick="exportFormal()">ğŸ“„ ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button></div>`;
      c.appendChild(fc);
    } catch(e) {
      ld.remove();
      const ed = mk('div','');
      ed.style.cssText = 'padding:12px;background:rgba(224,82,82,0.08);border:1px solid rgba(224,82,82,0.25);border-radius:8px;font-size:12px;color:var(--red)';
      ed.textContent = 'âŒ ' + e.message;
      c.appendChild(ed);
    }
  }

  function cpFormal(btn) {
    navigator.clipboard.writeText(window._formal||'').then(()=>{btn.textContent='âœ… ØªÙ…';setTimeout(()=>btn.textContent='ğŸ“‹ Ù†Ø³Ø®',2000)});
  }

  function exportRep() { dl(window._rep||'', 'forensic-report'); }
  function exportFormal() { dl(window._formal||'', 'forensic-report-official'); }
  function dl(txt, name) {
    const a = document.createElement('a');
    a.href = URL.createObjectURL(new Blob([txt],{type:'text/plain;charset=utf-8'}));
    a.download = `${name}-${Date.now()}.txt`; a.click();
  }

  async function testKey() {
    const key = document.getElementById('groqKey').value.trim();
    if (!key) { alert('âš ï¸ Ø£Ø¯Ø®Ù„ Ø§Ù„Ù€ API Key Ø£ÙˆÙ„Ø§Ù‹'); return; }
    const dot = document.getElementById('sDot');
    const txt = document.getElementById('sTxt');
    txt.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...';
    try {
      const r = await fetch('https://api.groq.com/openai/v1/chat/completions', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${key}` },
        body: JSON.stringify({
          model: 'llama-3.3-70b-versatile',
          max_tokens: 5,
          messages: [{ role: 'user', content: 'hi' }]
        })
      });
      const d = await r.json();
      if (d.error) throw new Error(d.error.message);
      dot.classList.add('on');
      txt.textContent = 'âœ… Ù…ØªØµÙ„';
      setTimeout(() => { txt.textContent = 'Ø¬Ø§Ù‡Ø²'; dot.classList.remove('on'); }, 3000);
    } catch(e) {
      dot.classList.remove('on');
      txt.textContent = 'âŒ Ø®Ø·Ø£';
      alert('âŒ ' + e.message);
      setTimeout(() => txt.textContent = 'Ø¬Ø§Ù‡Ø²', 3000);
    }
  }

  function mk(tag, cls) { const el=document.createElement(tag); if(cls)el.className=cls; return el; }
</script>
</body>
</html>
